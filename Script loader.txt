(function() {
    'use strict';

    // Create the modal window
    const modal = document.createElement('div');
    modal.style.position = 'fixed';
    modal.style.top = '50%';
    modal.style.left = '50%';
    modal.style.transform = 'translate(-50%, -50%)';
    modal.style.backgroundColor = 'white';
    modal.style.padding = '20px';
    modal.style.boxShadow = '0 0 10px rgba(0,0,0,0.5)';
    modal.style.zIndex = 9999;
    modal.style.width = '300px';
    modal.style.display = 'none';  // Hide initially

    // Create the title
    const title = document.createElement('h3');
    title.textContent = 'Script Loader UI';
    modal.appendChild(title);

    // Create the buttons container
    const buttonContainer = document.createElement('div');
    modal.appendChild(buttonContainer);

    // Button 1: "Test Functions"
    const testButton = document.createElement('button');
    testButton.textContent = 'Test Functions';
    testButton.style.margin = '10px';
    testButton.addEventListener('click', function() {
        loadAndExecuteScript();
    });
    buttonContainer.appendChild(testButton);

    // Function to dynamically load and execute the script from the .txt file
    function loadAndExecuteScript() {
        GM_xmlhttpRequest({
            method: 'GET',
            url: 'https://raw.githubusercontent.com/HaraldErik/Chrome-script-loader/refs/heads/main/Script%20loader.txt',
            onload: function(response) {
                if (response.status === 200) {
                    const scriptContent = response.responseText;
                    try {
                        eval(scriptContent);
                        alert("Script loaded and executed successfully!");
                    } catch (e) {
                        console.error('Error evaluating script:', e);
                    }
                } else {
                    console.error('Failed to load script:', response.status, response.statusText);
                }
            },
            onerror: function(error) {
                console.error('Request failed:', error);
            }
        });
    }

    // Append the modal window to the body
    document.body.appendChild(modal);

    // Show the modal after the page loads
    window.onload = function() {
        modal.style.display = 'block';
    };

    // Add some basic styles to improve the UI
    GM_addStyle(`
        button {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            margin: 5px 0;
        }
        button:hover {
            background-color: #45a049;
        }
        h3 {
            text-align: center;
            font-size: 20px;
            margin-bottom: 20px;
        }
    `);
})();